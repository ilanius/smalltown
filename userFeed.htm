<!doctype html>
<html>
<head>
<?php require 'head.htm'; ?>

<script>
  var profileId = <?=$R['profileId']?>;
  
</script>
</head>

<body class="feed">
  <div class="headPane"> <!-- flex box here -->
    <a href="?func=userFeedEvent">Logo</a> &nbsp; 
    <form action="?func=userSearch" method="post">
      <input type="text" name="search" id="search" class="search" placeholder="search">
    </form>
    <a href="?func=userAccount"> Account </a> 
    <a href="?func=userFeedProfile"> Me </a> <a href="?func=userLogout">Logout</a>
  </div>

  <div class="contPane"> 
    <span onclick="insertInput('');"> -comment- </span>
    <span class="postComment" id="comm_">  </span> 
    
    <?php
    function createFeed( &$posts, &$feed  ) {
      if ( sizeof( $posts ) == 0 ) return;
      foreach( $posts as &$p ) {
        $p['fromTo'] = $p['uId'];
        if ( isset( $p['ruId']) && $p['ruId'] != $p['uId'] ) {
          $p['fromTo'] .= '=>'.$p['ruId'];
        }
        $feed = $feed . "
        <div class='post'>
          <span class='fromTo'>$p[fromTo] </span><div class='pTxt'> $p[pTxt] </div>
          <span id=\"emot_$p[pId]\" onclick=\"alert($p[pId])\"> -like/dislike- </span>
          <span id=\"emot_$p[pId]\" onclick=\"alert($p[pId])\"> -delete - </span>
          <span onclick=\"insertInput($p[pId])\"> -comment- </span>\n";
        createFeed( $p['child'], $feed );
        $feed = $feed . "
        <span class=\"postComment\" id=\"comm_$p[pId]\">  </span> \n
        </div>";
      }
    }
    if ( sizeof( $R['posts'] ) > 0 ) {
    $tree = buildTree( $posts );
    $feed = "";
    createFeed( $tree, $feed );
    echo $feed;
    } else {
      echo "<p>Nothing here yet!</p>";
    }
    ?>
  </div>
  <div class="footPane"> 
      Debug stmnt1: <?=$R['stmnt1']?> <br>
      Debug stmnt2: <?=$R['stmnt2']?> 
  </div>

</body>
</html>
